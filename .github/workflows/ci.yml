stages:
  - sca

sca_backend:
  stage: sca
  image: owasp/dependency-check:latest
  script:
    - mkdir -p odc-reports
    - dependency-check.sh --project "Security Shepherd" --scan . --format HTML --format JSON --out odc-reports --failOnCVSS 7
  artifacts:
    paths:
      - odc-reports
    when: always
    expire_in: one week

sca_frontend:
  stage: sca
  image: node:alpine3.10
  before_script:
    - npm install
    - npm install -g retire
  script:
    - retire --outputformat json --outputpath retirejs-report.json --severity high || true
  artifacts:
    paths:
      - retirejs-report.json
    when: always
    expire_in: one week
